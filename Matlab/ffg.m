%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                                      %
%                               Fast Fourier Transform                                 %
%                                                                                      %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

function [mod,fase,freq] = ffg(gr,N,dt)

N = floor(N/2)*2;
grf = fft(gr,N);

mod(2:(N/2)) = 2/N*abs(grf(2:(N/2)));
mod(1)       = abs(grf(1))*2/N;

freq = (1/dt)/N*(0:(N/2-1));

fase(2:(N/2)) = atan2(imag(grf(2:(N/2))),real(grf(2:(N/2))));
fase          = fase*(180/pi);
